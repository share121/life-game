import{d as e,s as t,W as a,X as n,Y as r,Z as s,r as o,_ as u,$ as i,a0 as l,a1 as c,a2 as f,t as y,F as d,a3 as x,b as p,n as v,a4 as m,o as h,a5 as g,a6 as S,a7 as w}from"../../vendor-cef09ace.js";import{u as k}from"../stores/config-3896533f.js";import{u as b}from"../stores/temp-40aeb51e.js";const J=["data-x","data-y"],N=e({__name:"HomeView",setup(e){const{col:N,row:O,divSize:T,updateSpeed:q,enabledTransition:C}=t(k());let{isStart:E,isLocked:F,isClean:_}=t(b()),j=a([]);function A(e,t){return j.find((a=>a.x===e&&a.y===t))}function I(e,t,a=!A(e,t)){!!A(e,t)?a||j.splice(function(e,t){return j.findIndex((a=>a.x===e&&a.y===t))}(e,t),1):a&&j.push({x:e,y:t})}const{workerFn:L}=n((e=>{const t=JSON.parse(e);function*a(...e){if(1===e.length)for(const t of e[0])yield[t];else{const t=[],n=e[0][0];for(const r of a(...e.slice(1)))t.push(r),yield[n,...r];for(const a of e[0].slice(1))for(const e of t)yield[a,...e]}}function n(e,t,a){return r(t,a).map((({x:t,y:a})=>function(t,a){return e.find((e=>e.x===t&&e.y===a))}(t,a)))}function r(e,t){return[...a([-1,0,1],[-1,0,1])].filter((([e,t])=>0!==e||0!==t)).map((([a,n])=>({x:e+a,y:t+n})))}const s=[],o=[];var u;return t.forEach((({x:e,y:t})=>{[{x:e,y:t},...r(e,t)].forEach((e=>{o.push(e)}))})),(u=o,u.filter(((e,t,a)=>a.findIndex((t=>{return a=e,n=t,JSON.stringify(a)===JSON.stringify(n);var a,n}))===t))).forEach((({x:e,y:a})=>{const r=function(e,a){return t.find((t=>t.x===e&&t.y===a))}(e,a);switch(n(t,e,a).reduce(((e,t)=>e+ +!!t),0)){case 2:break;case 3:r||s.push({x:e,y:a});break;default:r&&s.push({x:e,y:a})}})),JSON.stringify(s)}));function $(e,t){return Array(t-e).fill(e).map(((e,t)=>e+t))}r(E,(()=>{if(E.value){let e=performance.now();requestAnimationFrame((async function t(a){E.value&&(a-e>=q.value&&(e=a,JSON.parse(await L(JSON.stringify(j))).forEach((({x:e,y:t})=>{I(e,t)}))),requestAnimationFrame(t))}))}}));const z=s((()=>{let e=j.reduce(((e,t)=>t.y>e?t.y:e),O.value-1)+1;return $(j.reduce(((e,t)=>t.y<e?t.y:e),0),e)})),H=s((()=>{let e=j.reduce(((e,t)=>t.x>e?t.x:e),N.value-1)+1;return $(j.reduce(((e,t)=>t.x<e?t.x:e),0),e)}));r((()=>j.reduce(((e,t)=>t.y<e?t.y:e),0)),(async(e,t)=>{let a=document.querySelector("main");a&&e!==t&&0===a.scrollTop&&(await S(),a.scrollTop+=(T.value+8)*(t-e))})),r((()=>j.reduce(((e,t)=>t.x<e?t.x:e),0)),((e,t)=>{let a=document.querySelector("main");a&&e!==t&&(a.scrollLeft+=(T.value+8)*(t-e))}));const P=o(!1),{x:V,y:W}=u({type:"page"}),{element:X}=i({x:V,y:W}),{pressed:Y}=l(),{vibrate:Z}=c({pattern:[300,100,300]}),B=o(!1);function D(e){B.value&&"mouse"===e.pointerType||(P.value=!0)}function G(e){return!(!e.dataset.x||!e.dataset.y)}function K(e){if(G(e)){return{x:+e.dataset.x,y:+e.dataset.y}}}function M(e){if(e.target&&G(e.target)){const{x:t,y:a}=K(e.target);I(t,a)}}return r(P,(e=>{if(e&&X.value&&G(X.value)){let{x:e,y:t}=K(X.value);I(e,t),Z()}F.value=e})),r(Y,(e=>{e||(B.value=P.value=!1)})),r(X,(()=>{!Y.value&&P.value||(B.value=!0)})),r(X,(e=>{if(P.value&&e&&G(e)){let{x:t,y:a}=K(e);I(t,a)}})),r(_,(()=>{_&&(_.value=!1,j.length=0)})),(e,t)=>{const a=w;return f((h(),y("div",{class:"container",style:v({gridTemplateColumns:`repeat(${p(H).length}, auto)`,"--width":p(T)+"px","--height":p(T)+"px"}),onContextmenu:t[0]||(t[0]=m((()=>{}),["prevent"])),onClick:M,onPointerdown:t[1]||(t[1]=e=>P.value=B.value=!1)},[(h(!0),y(d,null,x(p(z),(e=>(h(),y(d,{key:e},[(h(!0),y(d,null,x(p(H),(t=>(h(),y("div",{key:t,"data-x":t,"data-y":e,class:g({true:A(t,e)}),style:v(p(C)?{}:{transition:"none"})},null,14,J)))),128))],64)))),128))],36)),[[a,D]])}}});export{N as _};
