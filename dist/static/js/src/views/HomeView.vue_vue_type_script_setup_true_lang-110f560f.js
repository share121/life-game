import{d as e,s as a,S as t,T as n,V as r,r as s,W as i,X as o,Y as u,Z as l,_ as c,t as f,F as d,$ as y,b as p,n as v,a0 as x,o as m,a1 as h,a2 as N,a3 as g}from"../../vendor-e802980e.js";import{u as S}from"../stores/config-a68805b4.js";import{u as k}from"../stores/temp-e9e7488a.js";const b=["data-x","data-y","onClick"],w=e({__name:"HomeView",setup(e){const{col:w,row:J,divSize:O,updateSpeed:T,enabledTransition:C}=a(S()),{isStart:E,isLocked:F}=a(k());let _=t([]);function j(e,a){return _.find((t=>t.x===e&&t.y===a))}function A(e,a,t=!j(e,a)){!!j(e,a)?t||_.splice(function(e,a){return _.findIndex((t=>t.x===e&&t.y===a))}(e,a),1):t&&_.push({x:e,y:a})}function q(e,a,t=1){return Array(Number((a-e)/t)).fill(e).map(((e,a)=>e+a*t))}n(E,(()=>{if(!E.value)return;let e=performance.now();requestAnimationFrame((async function a(t){if(E.value){if(t-e>=T.value){e=t;const{workerFn:a}=N((e=>{const a=JSON.parse(e);function*t(...e){if(1===e.length)for(const a of e[0])yield[a];else{const a=[],n=e[0][0];for(const r of t(...e.slice(1)))a.push(r),yield[n,...r];for(const t of e[0].slice(1))for(const e of a)yield[t,...e]}}function n(e,a,t){return r(a,t).map((({x:a,y:t})=>function(a,t){return e.find((e=>e.x===a&&e.y===t))}(a,t)))}function r(e,a){return[...t([-1,0,1],[-1,0,1])].filter((([e,a])=>!(0===e&&0===a))).map((([t,n])=>({x:e+t,y:a+n})))}const s=[],i=[];var o;return a.forEach((({x:e,y:a})=>{[{x:e,y:a},...r(e,a)].forEach((e=>{i.push(e)}))})),(o=i,o.filter(((e,a,t)=>t.findIndex((a=>{return t=e,n=a,JSON.stringify(t)===JSON.stringify(n);var t,n}))===a))).forEach((({x:e,y:t})=>{const r=function(e,t){return a.find((a=>a.x===e&&a.y===t))}(e,t);switch(n(a,e,t).reduce(((e,a)=>e+ +!!a),0)){case 2:break;case 3:r||s.push({x:e,y:t});break;default:r&&s.push({x:e,y:t})}})),JSON.stringify(s)}));JSON.parse(await a(JSON.stringify(_))).forEach((({x:e,y:a})=>{A(e,a)}))}requestAnimationFrame(a)}}))}));const I=r((()=>{let e=_.reduce(((e,a)=>a.y>e?a.y:e),J.value-1)+1;return q(_.reduce(((e,a)=>a.y<e?a.y:e),0),e)})),V=r((()=>{let e=_.reduce(((e,a)=>a.x>e?a.x:e),w.value-1)+1;return q(_.reduce(((e,a)=>a.x<e?a.x:e),0),e)})),$=s(!1),{x:z,y:H}=i({type:"page"}),{element:L}=o({x:z,y:H}),{pressed:W}=u(),{vibrate:X}=l({pattern:[300,100,300]}),Y=s(!1);function Z(e){("mouse"===e.pointerType&&!Y.value||"mouse"!==e.pointerType)&&($.value=!0)}return n($,(e=>{var a,t;if(e){let e=+(null==(a=L.value)?void 0:a.dataset.x),n=+(null==(t=L.value)?void 0:t.dataset.y);isNaN(e)||isNaN(n)||A(e,n)}X(),F.value=e})),n(W,(e=>{e||(Y.value=$.value=!1)})),n(L,(()=>{W.value&&!$.value&&(Y.value=!0)})),n(L,(e=>{if(!$.value)return;let a=+(null==e?void 0:e.dataset.x),t=+(null==e?void 0:e.dataset.y);isNaN(a)||isNaN(t)||A(a,t)})),(e,a)=>{const t=g;return c((m(),f("div",{class:"container",style:v({gridTemplateColumns:`repeat(${p(V).length}, auto)`,"--width":p(O)+"px","--height":p(O)+"px"}),onContextmenu:a[0]||(a[0]=x((()=>{}),["prevent"]))},[(m(!0),f(d,null,y(p(I),(e=>(m(),f(d,{key:e},[(m(!0),f(d,null,y(p(V),(a=>(m(),f("div",{key:a,"data-x":a,"data-y":e,onClick:t=>A(a,e),class:h({true:j(a,e)}),style:v(p(C)?{}:{transition:"none"})},null,14,b)))),128))],64)))),128))],36)),[[t,Z]])}}});export{w as _};
