import{d as e,s as a,S as t,T as n,V as s,r,W as u,X as l,Y as i,Z as o,_ as c,t as d,F as f,$ as y,b as p,n as v,a0 as x,o as m,a1 as h,a2 as N,a3 as b}from"../../vendor-03ba1e63.js";import{u as g}from"../stores/config-abccab56.js";import{u as k}from"../stores/temp-5ef071b4.js";const w=["data-x","data-y","onClick"],E=e({__name:"HomeView",setup(e){const{col:E,row:T,divWidth:C,divHeight:_,updateSpeed:j,enabledTransition:q}=a(g()),{isStart:A,isLocked:F}=a(k());let S=t([]);function*H(...e){if(1===e.length)for(const a of e[0])yield[a];else{let a=[];const t=e[0][0];for(const n of H(...e.slice(1)))a.push(n),yield[t,...n];for(const n of e[0].slice(1))for(const e of a)yield[n,...e]}}function I(e,a,t){return[...H([-1,0,1],[-1,0,1])].filter((([e,a])=>!(0===e&&0===a))).map((([n,s])=>{return r=a+n,u=t+s,null!=(l=e.find((e=>e.x===r&&e.y===u)))?l:null;var r,u,l}))}function V(e,a,t){return[...H([-1,0,1],[-1,0,1])].filter((([e,a])=>!(0===e&&0===a))).map((([e,n])=>({x:a+e,y:t+n})))}function W(e,a){return S.find((t=>t.x===e&&t.y===a))}function $(e,a,t=!W(e,a)){!!W(e,a)?t||S.splice(function(e,a){return S.findIndex((t=>t.x===e&&t.y===a))}(e,a),1):t&&S.push({x:e,y:a})}function L(e,a,t=1){return Array(Number((a-e)/t)).fill(e).map(((e,a)=>e+a*t))}n(A,(()=>{if(!A.value)return;let e=performance.now();requestAnimationFrame((function a(t){if(A.value){if(t-e>=j.value){e=t;let a=[],s=[];S.forEach((({x:e,y:a})=>{[{x:e,y:a},...V(0,e,a)].forEach((e=>{s.push(e)}))})),(n=s,n.filter(((e,a,t)=>t.findIndex((a=>N.isEqual(e,a)))===a))).forEach((({x:e,y:t})=>{let n=W(e,t);switch(I(S,e,t).reduce(((e,a)=>e+ +!!a),0)){case 2:break;case 3:n||a.push({x:e,y:t});break;default:n&&a.push({x:e,y:t})}})),a.forEach((({x:e,y:a})=>{$(e,a)}))}var n;requestAnimationFrame(a)}}))}));const X=s((()=>{let e=S.reduce(((e,a)=>a.y>e?a.y:e),T.value-1)+1;return L(S.reduce(((e,a)=>a.y<e?a.y:e),0),e)})),Y=s((()=>{let e=S.reduce(((e,a)=>a.x>e?a.x:e),E.value-1)+1;return L(S.reduce(((e,a)=>a.x<e?a.x:e),0),e)})),Z=r(!1),{x:z,y:B}=u({type:"page"}),{element:D}=l({x:z,y:B}),{pressed:G}=i(),{vibrate:J}=o({pattern:[300,100,300]}),K=r(!1);function M(e){("mouse"===e.pointerType&&!K.value||"mouse"!==e.pointerType)&&(Z.value=!0)}return n(Z,(e=>{var a,t;if(e){let e=+(null==(a=D.value)?void 0:a.dataset.x),n=+(null==(t=D.value)?void 0:t.dataset.y);isNaN(e)||isNaN(n)||$(e,n)}J(),F.value=e})),n(G,(e=>{e||(K.value=Z.value=!1)})),n(D,(()=>{G.value&&!Z.value&&(K.value=!0)})),n(D,(e=>{if(!Z.value)return;let a=+(null==e?void 0:e.dataset.x),t=+(null==e?void 0:e.dataset.y);isNaN(a)||isNaN(t)||$(a,t)})),(e,a)=>{const t=b;return c((m(),d("div",{class:"container",style:v({gridTemplateColumns:`repeat(${p(Y).length}, auto)`,"--width":p(C)+"px","--height":p(_)+"px"}),onContextmenu:a[0]||(a[0]=x((()=>{}),["prevent"]))},[(m(!0),d(f,null,y(p(X),(e=>(m(),d(f,{key:e},[(m(!0),d(f,null,y(p(Y),(a=>(m(),d("div",{key:a,"data-x":a,"data-y":e,onClick:t=>$(a,e),class:h({true:W(a,e)}),style:v(p(q)?{}:{transition:"none"})},null,14,w)))),128))],64)))),128))],36)),[[t,M]])}}});export{E as _};
