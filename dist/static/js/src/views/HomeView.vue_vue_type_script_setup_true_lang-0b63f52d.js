import{d as e,s as t,P as n,Q as r,R as o,p as a,F as s,S as u,a as i,T as l,V as f,o as c,W as d,X as y}from"../../vendor-3abdb3b7.js";import{u as p}from"../stores/config-a95d1d3b.js";import{u as x}from"../stores/temp-9071f13b.js";const m=["data-x","data-y","onMousedown","onMouseover"],h=e({__name:"HomeView",setup(e){const{col:h,row:v,divWidth:w,divHeight:b,updateSpeed:g,enabledTransition:E}=t(p()),{isStart:k}=t(x());let M=n([]);function*j(...e){if(1===e.length)for(const t of e[0])yield[t];else{let t=[];const n=e[0][0];for(const r of j(...e.slice(1)))t.push(r),yield[n,...r];for(const r of e[0].slice(1))for(const e of t)yield[r,...e]}}function q(e,t,n){return[...j([-1,0,1],[-1,0,1])].filter((([e,t])=>!(0===e&&0===t))).map((([r,o])=>{return a=t+r,s=n+o,null!=(u=e.find((e=>e.x===a&&e.y===s)))?u:null;var a,s,u}))}function A(e,t,n){return[...j([-1,0,1],[-1,0,1])].filter((([e,t])=>!(0===e&&0===t))).map((([e,r])=>({x:t+e,y:n+r})))}function F(e,t){return M.find((n=>n.x===e&&n.y===t))}function S(e,t,n=!F(e,t)){!!F(e,t)?n||M.splice(function(e,t){return M.findIndex((n=>n.x===e&&n.y===t))}(e,t),1):n&&M.push({x:e,y:t})}function T(e,t,n=1){return Array(Number((t-e)/n)).fill(e).map(((e,t)=>e+t*n))}r(k,(()=>{if(!k.value)return;let e=performance.now();requestAnimationFrame((function t(n){if(k.value){if(n-e>=g.value){e=n;let t=[],o=[];M.forEach((({x:e,y:t})=>{[{x:e,y:t},...A(0,e,t)].forEach((e=>{o.push(e)}))})),(r=o,r.filter(((e,t,n)=>n.findIndex((t=>y.isEqual(e,t)))===t))).forEach((({x:e,y:n})=>{let r=F(e,n);switch(q(M,e,n).reduce(((e,t)=>e+ +!!t),0)){case 2:break;case 3:r||t.push({x:e,y:n});break;default:r&&t.push({x:e,y:n})}})),t.forEach((({x:e,y:t})=>{S(e,t)}))}var r;requestAnimationFrame(t)}}))}));const _=o((()=>{let e=M.reduce(((e,t)=>t.y>e?t.y:e),v.value-1)+1;return T(M.reduce(((e,t)=>t.y<e?t.y:e),0),e)})),C=o((()=>{let e=M.reduce(((e,t)=>t.x>e?t.x:e),h.value-1)+1;return T(M.reduce(((e,t)=>t.x<e?t.x:e),0),e)}));return(e,t)=>(c(),a("div",{class:"container",style:l({gridTemplateColumns:`repeat(${i(C).length}, auto)`,"--width":i(w)+"px","--height":i(b)+"px"}),onContextmenu:t[0]||(t[0]=f((()=>{}),["prevent"]))},[(c(!0),a(s,null,u(i(_),(e=>(c(),a(s,{key:e},[(c(!0),a(s,null,u(i(C),(t=>(c(),a("div",{key:t,"data-x":t,"data-y":e,class:d({true:F(t,e)}),onMousedown:n=>S(t,e),onMouseover:n=>0!==n.buttons&&S(t,e),style:l(i(E)?{}:{transition:"none"})},null,46,m)))),128))],64)))),128))],36))}});export{h as _};
