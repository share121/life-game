import{d as e,s as a,T as t,w as n,V as s,r,W as i,X as l,Y as o,Z as u,_ as c,v as d,F as f,$ as y,e as p,n as x,a0 as v,o as m,a1 as h,a2 as N,a3 as g}from"../../vendor-521a8e3c.js";import{u as k}from"../stores/config-e32d92d6.js";import{u as b}from"../stores/temp-ca71d587.js";const w=["data-x","data-y","onClick"],E=e({__name:"HomeView",setup(e){const{col:E,row:C,divWidth:_,divHeight:j,updateSpeed:q,enabledTransition:A}=a(k()),{isStart:F,isLocked:T}=a(b());let H=t([]);function*I(...e){if(1===e.length)for(const a of e[0])yield[a];else{let a=[];const t=e[0][0];for(const n of I(...e.slice(1)))a.push(n),yield[t,...n];for(const n of e[0].slice(1))for(const e of a)yield[n,...e]}}function S(e,a,t){return[...I([-1,0,1],[-1,0,1])].filter((([e,a])=>!(0===e&&0===a))).map((([n,s])=>{return r=a+n,i=t+s,null!=(l=e.find((e=>e.x===r&&e.y===i)))?l:null;var r,i,l}))}function V(e,a,t){return[...I([-1,0,1],[-1,0,1])].filter((([e,a])=>!(0===e&&0===a))).map((([e,n])=>({x:a+e,y:t+n})))}function W(e,a){return H.find((t=>t.x===e&&t.y===a))}function $(e,a,t=!W(e,a)){!!W(e,a)?t||H.splice(function(e,a){return H.findIndex((t=>t.x===e&&t.y===a))}(e,a),1):t&&H.push({x:e,y:a})}function L(e,a,t=1){return Array(Number((a-e)/t)).fill(e).map(((e,a)=>e+a*t))}n(F,(()=>{if(!F.value)return;let e=performance.now();requestAnimationFrame((function a(t){if(F.value){if(t-e>=q.value){e=t;let a=[],s=[];H.forEach((({x:e,y:a})=>{[{x:e,y:a},...V(0,e,a)].forEach((e=>{s.push(e)}))})),(n=s,n.filter(((e,a,t)=>t.findIndex((a=>N.isEqual(e,a)))===a))).forEach((({x:e,y:t})=>{let n=W(e,t);switch(S(H,e,t).reduce(((e,a)=>e+ +!!a),0)){case 2:break;case 3:n||a.push({x:e,y:t});break;default:n&&a.push({x:e,y:t})}})),a.forEach((({x:e,y:a})=>{$(e,a)}))}var n;requestAnimationFrame(a)}}))}));const X=s((()=>{let e=H.reduce(((e,a)=>a.y>e?a.y:e),C.value-1)+1;return L(H.reduce(((e,a)=>a.y<e?a.y:e),0),e)})),Y=s((()=>{let e=H.reduce(((e,a)=>a.x>e?a.x:e),E.value-1)+1;return L(H.reduce(((e,a)=>a.x<e?a.x:e),0),e)})),Z=r(!1),{x:z,y:B}=i({type:"page"}),{element:D}=l({x:z,y:B}),{pressed:G}=o(),{vibrate:J}=u({pattern:[300,100,300]});return n(Z,(e=>{var a,t;if(e){let e=+(null==(a=D.value)?void 0:a.dataset.x),n=+(null==(t=D.value)?void 0:t.dataset.y);isNaN(e)||isNaN(n)||$(e,n)}J(),T.value=e})),n(G,(e=>{e||(Z.value=!1)})),n(D,(e=>{if(!Z.value)return;let a=+(null==e?void 0:e.dataset.x),t=+(null==e?void 0:e.dataset.y);isNaN(a)||isNaN(t)||$(a,t)})),(e,a)=>{const t=g;return c((m(),d("div",{class:"container",style:x({gridTemplateColumns:`repeat(${p(Y).length}, auto)`,"--width":p(_)+"px","--height":p(j)+"px"}),onContextmenu:a[0]||(a[0]=v((()=>{}),["prevent"]))},[(m(!0),d(f,null,y(p(X),(e=>(m(),d(f,{key:e},[(m(!0),d(f,null,y(p(Y),(a=>(m(),d("div",{key:a,"data-x":a,"data-y":e,onClick:t=>$(a,e),class:h({true:W(a,e)}),style:x(p(A)?{}:{transition:"none"})},null,14,w)))),128))],64)))),128))],36)),[[t,()=>{Z.value=!0}]])}}});export{E as _};
